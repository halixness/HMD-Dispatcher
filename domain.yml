version: '3.1'


intents:
- greet
- patient_inputs_homeaddr
- patient_inputs_phone
- patient_asks_cause
- patient_asks_change_lifestyle
- patient_asks_effect_lifestyle
- patient_asks_learn
- patient_asks_longterm_effects
- patient_asks_permanent
- patient_asks_symptoms_persist
- patient_asks_treatment
- patient_reports_abdominal_pain
- patient_reports_respiratory_difficulty


entities:
- patient_phonenmbr
- patient_homeaddr


slots:

  # ======================================================
  #  General
  # ======================================================
  reported_pathology:
    type: categorical
    values:
    - patient_reports_abdominal_pain
    - patient_reports_respiratory_difficulty
    - patient_reports_poisoning
    mappings:
    - type: custom
  patient_homeaddr:
    type: any
    mappings:
    - type: from_entity
      entity: patient_homeaddr
  patient_phonenmbr:
    type: any
    mappings:
    - type: from_entity
      entity: patient_phonenmbr

  # ======================================================
  #  (1) Abdominal pain
  # ======================================================
  abdominal_pain_time:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_abdominal_pain
        requested_slot: abdominal_pain_time
  abdominal_pain_area:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_abdominal_pain
        requested_slot: abdominal_pain_area
  abdominal_pain_type:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_abdominal_pain
        requested_slot: abdominal_pain_type
  abdominal_pain_worsening:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_abdominal_pain
        requested_slot: abdominal_pain_worsening
  abdominal_pain_relief:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_abdominal_pain
        requested_slot: abdominal_pain_relief
  abdominal_pain_duration:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_abdominal_pain
        requested_slot: abdominal_pain_duration
        
  # ======================================================
  #  (2) Respiratory difficulty
  # ======================================================
  respiratory_difficulty_atnight:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_atnight
  respiratory_difficulty_before:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_before
  respiratory_difficulty_suddenly:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_suddenly
  respiratory_difficulty_recentchanges:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_recentchanges
  respiratory_difficulty_regularly:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_regularly
  respiratory_difficulty_worsens:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_worsens
  respiratory_difficulty_ankles:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_ankles
  respiratory_difficulty_weeks:
    type: text
    mappings:
    - type: from_text
      conditions:
      - active_loop: form_emergency_respiratory_difficulty
        requested_slot: respiratory_difficulty_weeks


actions:
- utter_greet
- action_ask_patient_homeaddr
- utter_ask_patient_phonenmbr
- utter_start_medical_questions
- validate_form_general_info
- action_set_pathology


responses:
  # ======================================================
  #  General
  # ======================================================
  utter_start_medical_questions:
  - text: Tell me what's the issue.
  utter_repeat_last_time:
  - text: Let's retry one last time.
  utter_please_rephrase:
  - text: I'm sorry, I didn't quite understand that. Could you rephrase?
  utter_greet:
  - text: Hello, this is the Ambulance Emergency Dispatcher. To talk with a human operator, just ask anytime.
  utter_please_specify_pathology:
  - text: Sorry, I need you to give me some details about your pathology first.
  utter_please_provide_general_info:
  - text: To possibly send help for your emergency, I need some details first.

  # ======================================================
  #  Personal details
  # ======================================================
  utter_ask_patient_homeaddr:
  - text: Can you {verb} your home address, please?
  utter_invalid_patient_homeaddr:
  - text: I'm sorry, we can't find this address on the map.
  utter_ask_patient_phonenmbr:
  - text: And what's your phone number?
  
  # ======================================================
  #  (1) Abdominal pain
  # ======================================================
  utter_ask_abdominal_pain_time:
  - text: When does the pain occur? In the morning? After eating? Always?
  utter_ask_abdominal_pain_area:
  - text: Where does the pain occur? In the entire abdomen or a specific area?
  utter_ask_abdominal_pain_type:
  - text: What type of pain are you experiencing? Dull ache? Sharp pain? Persistent or in waves?
  utter_ask_abdominal_pain_worsening:
  - text: What makes the pain worse? Coughing?
  utter_ask_abdominal_pain_relief:
  - text: What makes the pain better? Eating? Not eating?
  utter_ask_abdominal_pain_duration:
  - text: How long have you experienced this pain? Days? Months?
  utter_answ_cause_abdominal_pain:
  - text: Abdominal pain can be caused by a variety of factors, including indigestion, constipation, gastritis, ulcers, food poisoning, or more serious conditions such as appendicitis, gallstones, or inflammatory bowel disease.
  utter_answ_permanent_abdominal_pain:
  - text: The permanence of abdominal pain depends on its underlying cause. Some conditions may resolve with treatment, while others may require ongoing management. It's important to consult a healthcare professional for an accurate diagnosis and prognosis.
  utter_conclude_abdominal_pain:
  - text: Ok, I have collected all the necessary info about your abdominal pain. Paramedics are on the way. While we're waiting, do you have any questions?
  
  # ======================================================
  #  (2) Respiratory difficulty
  # ======================================================
  utter_ask_respiratory_difficulty_atnight:
  - text: Do you have any problems breathing at night? 
  utter_ask_respiratory_difficulty_before:
  - text: Have you experienced this difficulty breathing before? 
  utter_ask_respiratory_difficulty_suddenly:
  - text: Did this episode come on suddenly? 
  utter_ask_respiratory_difficulty_recentchanges:
  - text: Have you had any recent changes in exertional capacity, fatigue, or significant weight change? 
  utter_ask_respiratory_difficulty_regularly:
  - text: Are you feeling short of breath regularly? 
  utter_ask_respiratory_difficulty_worsens:
  - text: Does your shortness of breath get worse when you've been doing your normal activities, or when you lie down? 
  utter_ask_respiratory_difficulty_ankles:
  - text: Do you have swollen ankles along with shortness of breath? 
  utter_ask_respiratory_difficulty_weeks:
  - text: Are you coughing for 3 weeks or more?
  utter_conclude_respiratory_difficulty:
  - text: Ok, I have collected all the necessary info about your respiratory difficulty. Paramedics are on the way. While we're waiting, do you have any questions?
  
  # ======================================================
  #  (3) Poisoning
  # ======================================================
  utter_ask_poisoning_first:
  - text: bruh.mp3

forms:

  form_general_info:
    required_slots:
    - patient_homeaddr
    - patient_phonenmbr

  form_emergency_abdominal_pain:
    required_slots:
    - abdominal_pain_time
    - abdominal_pain_area
    - abdominal_pain_type
    - abdominal_pain_worsening
    - abdominal_pain_relief
    - abdominal_pain_duration

  form_emergency_respiratory_difficulty:
    required_slots:
    - respiratory_difficulty_atnight
    - respiratory_difficulty_usepillows
    - respiratory_difficulty_pastexp
    - respiratory_difficulty_frequency
    - respiratory_difficulty_familiarity

  form_emergency_poisoning:
    required_slots:
    - poisoning_first


